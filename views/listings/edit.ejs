<% layout("/layouts/boilerplate") %>

<div class="row mt-3">
  <div class="col-12 col-lg-8 offset-lg-2" style="margin: 0 auto;">
    <div class="card" style="border: none; box-shadow: var(--shadow-xl); border-radius: 24px; padding: 3rem;">
      <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-align: center;">
        Update Your Vehicle Details:
      </h1>
      <p style="color: var(--text-light); margin-bottom: 2rem; text-align: center;"></p>

      <form method="post" action="/listings/<%= listing._id %>?_method=PUT" 
            novalidate class="needs-validation" enctype="multipart/form-data">
        
        <div class="mb-3">
          <label for="title" class="form-label">Title</label>
          <input type="text" id="title" name="listing[title]" class="form-control"
                 value="<%= listing.title %>" required>
        </div>

        <div class="mb-3">
          <label for="description" class="form-label">Description</label>
          <textarea id="description" name="listing[description]" class="form-control" rows="5" required><%= listing.description %></textarea>
        </div>

        <div class="mb-3">
          <label class="form-label">Current Image</label>
          <div style="margin-top: 0.5rem;">
            <img src="<%= originalImage %>" alt="Current Image" 
                 style="max-width: 300px; border-radius: 12px; box-shadow: var(--shadow-md);">
          </div>
        </div>

        <div class="mb-3">
          <label for="image" class="form-label">Upload New Image (optional)</label>
          <input type="file" id="image" name="listing[image]" class="form-control" accept="image/*">
          <small style="color: var(--text-light);">Leave empty to keep current image</small>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label for="price" class="form-label">Price (per day)</label>
            <input type="number" id="price" name="listing[price]" class="form-control"
                   value="<%= listing.price %>" min="0" required>
          </div>

          <div class="col-md-6 mb-3">
            <label for="country" class="form-label">Country</label>
            <input type="text" id="country" name="listing[country]" class="form-control"
                   value="<%= listing.country %>" required>
          </div>
        </div>

        <div class="mb-3">
          <label for="location" class="form-label">Location</label>
          <input type="text" id="location" name="listing[location]" class="form-control"
                 value="<%= listing.location %>" required>
        </div>

        <div class="d-grid gap-2 mt-4">
          <button type="submit" class="btn btn-success" style="padding: 1rem;">
            <i class="fa-solid fa-save me-2"></i> Update Listing
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
